<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Áreas de Atuação dos Professores (Local)</title>
    
    <style>
        /* (Mantenha seu CSS aqui) */
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f4f4f9; }
        .container { max-width: 900px; margin: 0 auto; padding: 20px; background-color: #fff; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); border-radius: 8px; }
        .professor-card { border: 1px solid #ddd; padding: 20px; margin-bottom: 20px; border-radius: 6px; background-color: #fafafa; }
        .professor-card h2 { color: #0056b3; margin-top: 0; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        .professor-card .atuacao-content h1 { font-size: 1.5em; color: #333; }
        .professor-card .atuacao-content h2 { font-size: 1.3em; color: #555; }
        .professor-card .atuacao-content ul, .professor-card .atuacao-content ol { margin-left: 20px; }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/marked@12.0.0/lib/marked.umd.min.js"></script>
</head>
<body>

    <div class="container">
        <h1>Áreas de Pesquisa e TCC dos Professores</h1>
        <p>Informações de atuação buscadas do repositório centralizado.</p>
        <div id="professores-list">Carregando dados...</div>
    </div>

    <script>
        const professoresList = document.getElementById('professores-list');
        const CONFIG_PATH = './professores_config.json'; // Caminho para o JSON de configuração
        const MARCKDOWN_FOLDER = 'professores/';

        /**
         * Cria o card inicial na tela.
         */
        function criarCardInicial(professor) {
            const card = document.createElement('div');
            card.className = 'professor-card';
            card.innerHTML = `<h2>${professor.nome}</h2><div class="atuacao-content">Buscando informações...</div>`;
            professoresList.appendChild(card);
            return card;
        }

        /**
         * Busca o arquivo Markdown local e renderiza o conteúdo.
         * @param {Object} professor - O objeto de configuração do professor.
         */
        function fetchAndRenderMarkdown(professor) {
            const card = criarCardInicial(professor);
            const contentContainer = card.querySelector('.atuacao-content');
            
            // Acessa o arquivo no mesmo repositório (caminho relativo)
            const url = MARCKDOWN_FOLDER + professor.arquivo_markdown; 

            // Adiciona um timestamp para garantir que o navegador não use cache antigo
            const urlWithCacheBuster = `${url}?t=${new Date().getTime()}`;

            fetch(urlWithCacheBuster)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`Arquivo não encontrado (Status: ${response.status})`);
                    }
                    return response.text(); // Pega o conteúdo Markdown puro
                })
                .then(markdownText => {
                    // Converte o Markdown em HTML
                    const htmlContent = marked.parse(markdownText);
                    contentContainer.innerHTML = htmlContent;
                })
                .catch(error => {
                    console.error(`Erro ao buscar ${professor.nome}:`, error.message);
                    contentContainer.innerHTML = `
                        <p style="color: red;">
                            <strong>ERRO:</strong> Não foi possível carregar o arquivo.
                        </p>
                        <p>Verifique o caminho do arquivo: <strong>${url}</strong></p>
                    `;
                });
        }
        
        /**
         * Função principal: Busca a lista de professores e inicia a renderização.
         */
        function carregarProfessores() {
            fetch(CONFIG_PATH)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`Erro ao carregar a configuração: ${CONFIG_PATH} não encontrado.`);
                    }
                    return response.json(); // Pega a lista de professores
                })
                .then(PROFESSORES_CONFIG => {
                    professoresList.innerHTML = ''; // Limpa o "Carregando dados..."
                    
                    // Execução: Busca cada arquivo Markdown
                    PROFESSORES_CONFIG.forEach(fetchAndRenderMarkdown);
                })
                .catch(error => {
                    professoresList.innerHTML = `<div style="color: red;"><strong>ERRO FATAL:</strong> ${error.message}</div>`;
                });
        }

        // Inicia o processo
        carregarProfessores();
    </script>
</body>
</html>
